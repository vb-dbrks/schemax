# Repository Structure

This document describes the organization and purpose of files in the SchemaX repository.

## Root Directory

```
schemax-vscode/
├── README.md                  # Project overview and quick start
├── CHANGELOG.md               # Version history and changes
├── CONTRIBUTING.md            # Contribution guidelines
├── LICENSE                    # MIT license
├── package.json               # NPM package configuration
├── package-lock.json          # NPM dependency lock file
├── tsconfig.json              # TypeScript config for extension
├── tsconfig.webview.json      # TypeScript config for webview
├── esbuild.config.mjs         # Extension build configuration
├── vite.config.ts             # Webview build configuration
├── .gitignore                 # Git ignore patterns
├── .vscodeignore              # VS Code packaging ignore patterns
└── .cursorrules               # AI assistant project context
```

## Source Code (`src/`)

### Extension Host

```
src/
├── extension.ts               # Main extension entry point
├── storage-v2.ts              # File I/O and state management
├── telemetry.ts               # Analytics stub
└── shared/                    # Code shared between extension and webview
    ├── model.ts               # Zod schemas for data models
    └── ops.ts                 # Operation type definitions
```

**Key Files:**
- `extension.ts` - Registers commands, creates webview, handles message passing
- `storage-v2.ts` - All file operations for project, changelog, and snapshots
- `shared/model.ts` - Data validation schemas using Zod
- `shared/ops.ts` - Operation type definitions for change tracking

### Webview (React)

```
src/webview/
├── main.tsx                   # Webview entry point
├── App.tsx                    # Root React component
├── index.html                 # Webview HTML template
├── styles.css                 # Global styles
├── vscode-api.ts              # VS Code API singleton
├── state/
│   └── useDesignerStore.ts    # Zustand state management
└── components/
    ├── Toolbar.tsx            # Action buttons
    ├── Sidebar.tsx            # Tree view (catalogs/schemas/tables)
    ├── TableDesigner.tsx      # Table properties editor
    ├── ColumnGrid.tsx         # Column grid with inline editing
    └── SnapshotPanel.tsx      # Version history timeline
```

**Key Files:**
- `useDesignerStore.ts` - Central state management, generates operations
- `ColumnGrid.tsx` - Inline editing for columns
- `SnapshotPanel.tsx` - Visual snapshot timeline
- `vscode-api.ts` - Singleton for VS Code API access

## Build Output

```
dist/
├── extension.js               # Compiled extension bundle
└── extension.js.map           # Source map

media/                         # Webview assets
├── index.html                 # Webview HTML
└── assets/
    ├── index.js               # Webview JavaScript bundle
    └── index.css              # Webview CSS bundle
```

**Generated by:**
- `dist/` - esbuild (from `src/extension.ts`)
- `media/` - Vite (from `src/webview/`)

## Documentation (`docs/`)

```
docs/
├── QUICKSTART.md              # 5-minute getting started guide
├── DEVELOPMENT.md             # Development setup and guidelines
├── ARCHITECTURE.md            # Technical design and decisions
└── REPO-STRUCTURE.md          # This file
```

**Purpose:**
- `QUICKSTART.md` - New user onboarding
- `DEVELOPMENT.md` - Developer setup, testing, contributing
- `ARCHITECTURE.md` - Deep dive into design and implementation
- `REPO-STRUCTURE.md` - Repository organization

## Configuration Files

### TypeScript

- **`tsconfig.json`** - Extension (Node.js target)
  - Strict mode enabled
  - CommonJS modules
  - Target: ES2020

- **`tsconfig.webview.json`** - Webview (Browser target)
  - Extends main config
  - Includes React JSX
  - Target: ES2020

### Build Tools

- **`esbuild.config.mjs`** - Extension bundler
  - Entry: `src/extension.ts`
  - Output: `dist/extension.js`
  - Platform: Node.js
  - External: `vscode` module

- **`vite.config.ts`** - Webview bundler
  - Entry: `src/webview/main.tsx`
  - Output: `media/`
  - React plugin enabled
  - Build mode optimizations

### VS Code Extension

- **`package.json`** - Extension manifest
  - Commands contributed
  - Activation events
  - Dependencies
  - Scripts
  - Publishing metadata

- **`.vscodeignore`** - Packaging exclusions
  - Source files (`src/`)
  - Development configs
  - Documentation
  - Git files

### Version Control

- **`.gitignore`** - Git exclusions
  - `node_modules/`
  - `dist/` and `media/` (build output)
  - `*.vsix` (packages)
  - `.DS_Store` (macOS)

## User Data Files

When users run SchemaX, it creates a `.schemax/` directory in their workspace:

```
.schemax/
├── project.json               # Project metadata
├── changelog.json             # Uncommitted operations
└── snapshots/
    ├── v0.1.0.json           # Snapshot files
    ├── v0.2.0.json
    └── v0.3.0.json
```

**Not in repository** - These are user-generated files.

## Development Files (Not in Repository)

```
node_modules/                  # NPM dependencies
.vscode-test/                  # VS Code test runtime
*.vsix                         # Packaged extension files
```

## File Sizes (Approximate)

**Source Code:**
- Extension TypeScript: ~15 KB
- Webview TypeScript: ~30 KB
- Shared code: ~10 KB
- Total source: ~55 KB

**Build Output:**
- Extension bundle: ~50 KB
- Webview bundle: ~170 KB (includes React)
- Total package: ~220 KB

**Documentation:**
- README: ~5 KB
- Developer docs: ~40 KB
- Total docs: ~45 KB

## Key Patterns

### Imports

Extension code:
```typescript
import * as vscode from 'vscode';
import * as storageV2 from './storage-v2';
import { ProjectFile } from './shared/model';
```

Webview code:
```typescript
import React from 'react';
import { useDesignerStore } from './state/useDesignerStore';
import { getVsCodeApi } from './vscode-api';
```

### Exports

Public functions (storage-v2.ts):
```typescript
export async function readProject(uri: vscode.Uri): Promise<ProjectFile> {
  // ...
}
```

React components:
```typescript
export function Toolbar() {
  // ...
}
```

### File Naming

- **PascalCase**: React components (`Toolbar.tsx`)
- **kebab-case**: Config files (`esbuild.config.mjs`)
- **camelCase**: TypeScript files (`storage-v2.ts`)
- **UPPERCASE**: Documentation (`README.md`)

## Dependencies

### Runtime

- `react` & `react-dom` - UI framework
- `zustand` - State management
- `zod` - Schema validation
- `uuid` - UUID generation

### Development

- `typescript` - Language
- `esbuild` - Extension bundler
- `vite` - Webview bundler
- `@vitejs/plugin-react` - React support
- `@vscode/vsce` - Extension packaging
- `concurrently` - Run multiple processes

### Type Definitions

- `@types/node` - Node.js types
- `@types/vscode` - VS Code API types
- `@types/react` - React types
- `@types/react-dom` - React DOM types
- `@types/uuid` - UUID types

## Maintenance

### Files to Update for Releases

1. `package.json` - version number
2. `CHANGELOG.md` - version history
3. `README.md` - if features added
4. Tag git commit: `git tag v0.X.0`

### Files to Update for New Features

1. Source code (`src/`)
2. `README.md` - feature description
3. `docs/DEVELOPMENT.md` - if architecture changes
4. `CHANGELOG.md` - add to unreleased section

### Files to Update for Documentation

1. Relevant docs in `docs/`
2. `README.md` - if user-facing
3. Code comments - inline documentation

## Related Documentation

- [README](../README.md) - Project overview
- [CONTRIBUTING](../CONTRIBUTING.md) - How to contribute
- [DEVELOPMENT](DEVELOPMENT.md) - Setup and workflow
- [ARCHITECTURE](ARCHITECTURE.md) - Technical design
- [QUICKSTART](QUICKSTART.md) - User guide
- [CHANGELOG](../CHANGELOG.md) - Version history

